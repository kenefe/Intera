# 旅程: 状态系统 — 通知卡片展开/收起

## 画像
**状态系统 (states)** — 能力集: {states}

## 设计目标
创建一个通知卡片，有"收起"和"展开详情"两个显示状态。收起时只显示标题区域（小矩形），展开时卡片变高、透明度变化。覆盖能力：状态创建、属性覆盖（高度+透明度）、状态切换预览。

## 过程

### Step 1-2: 初始画面 + 切换矩形工具
- 截图: screenshots/step-01.png, step-02.png
- 看到 Intera 四栏布局，空画布，底部状态栏只有"默认"
- 按 R 切换到矩形工具

### Step 3: 绘制卡片背景
- 截图: screenshots/step-03.png
- 在画板中拖拽画出矩形 1 (W:620, H:331)
- 灰色矩形出现，图层面板显示"矩形 1"
- 属性面板正确显示所有属性

### Step 4-15: 尝试修改属性值
- 截图: step-04 ~ step-15
- 多次尝试点击 W 输入框修改宽度值
- **摩擦点**: number input 点击行为不直观 — 点击数值区域有时触发 step 微调（W 从 620→619→618），而不是聚焦输入框进行编辑。Ctrl+A 在输入框聚焦时会选中画布图层而非输入框内容
- 决策: 不纠结于精确尺寸，用当前矩形继续推进

### Step 21: 创建第二个状态 ✅
- 截图: screenshots/step-21.png
- 点击状态栏"默认"右侧的 "+" 按钮
- 成功创建"状态 2"，画布上出现两个画板并排显示
- **验证通过**: 状态创建功能正常

### Step 24: 状态覆盖 — 拖拽改高度 ✅
- 截图: screenshots/step-24.png
- 在状态 2 画板中拖拽矩形 1 底部手柄，高度从 331 增大到 621
- 属性面板出现"重置为基础值"按钮（橙色覆盖标记）
- 默认状态画板中矩形保持 H:331 不变
- **验证通过**: 状态感知写入正确 — 非默认状态修改只创建 override，不污染默认状态

### Step 27: 状态覆盖 — 修改透明度 ✅
- 截图: screenshots/step-27.png
- 在状态 2 中修改矩形 1 透明度为 0.71
- 右侧画板矩形明显变半透明
- **验证通过**: 透明度覆盖正常

### Step 33-34: 预览面板自动循环 ✅
- 截图: screenshots/step-33.png, step-34.png
- 点击左侧预览面板，属性面板在默认值和覆盖值之间切换
- **验证通过**: Level 0 自动循环工作正常（无 Touch Patch + 2 状态 → 点击循环）

### Step 36: 添加第二个图层 ✅
- 截图: screenshots/step-36.png
- 用矩形工具在画板内画矩形 2 (W:207, H:62)
- 矩形 2 同时出现在两个画板中
- **验证通过**: 共享图层树正常

### Step 46: 图层面板选中 ✅
- 截图: screenshots/step-46.png
- 通过图层面板点击"矩形 2"成功选中
- 属性面板正确显示矩形 2 的属性

## 摩擦点

### 1. 画布点击选层不稳定 (已知 P2)
- 在状态 2 画板中点击矩形 2 (小矩形叠在大矩形上) 无法选中
- 需要通过图层面板选中
- 已记录在 KNOWN-ISSUES.md

### 2. number input 编辑体验差 (已知 P2 相关)
- 点击属性面板的 number input 有时触发 step 微调而非聚焦编辑
- Ctrl+A 在 input 聚焦时选中画布图层而非 input 内容
- 用户需要精确点击数值文字区域才能编辑，容易误触 spinner 箭头

## 结论
**✅ 通过** — 状态系统核心能力全部验证通过：
- 状态创建
- 属性覆盖（高度、透明度）
- 覆盖标记 + 重置按钮
- 共享图层树
- 预览面板自动循环
- 图层面板选中

摩擦点均为已知 P2 问题，不阻塞核心流程。
